
@@@program xmlns:xsi="http://www.w3.org/2000/10/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../plantilla.xsd"@@@

 @@@saveto@@@
  @@@file overwrite="yes"@@@@@@v@@@jadeproject@@@/v@@@/build.xml@@@/file@@@
  @@@text@@@
 <project name="ingenias" default="run" basedir=".">
 <property name="gensrc" location="@@@v@@@jadeout@@@/v@@@" />
 <property name="permsrc" location="@@@v@@@jadeperm@@@/v@@@" />
 <property name="main" location="@@@v@@@proysrc@@@/v@@@" />
 <property name="temp" location="tmp" />
 <property name="genlib" location="genlib"/>
 <property name="doc" location="doc"/>
 <property name="lib" location="lib"/>
 <property name="spec" location="spec"/>
 <property name="bin" location="bin"/>
 <property name="test.results.dir" location="output/tests"/>
   	
 <!--   Compiles code generated by a JADE Module     -->
  <target name="compile" >

    
    <mkdir dir="jade" />
    <mkdir dir="${temp}" />
    <mkdir dir="${main}" />
    <mkdir dir="${permsrc}" />
    <mkdir dir="${gensrc}" />

    
    <copy todir="${temp}">
    <fileset dir="${main}">
      <include name="**/*.properties"/>
      <include name="**/*.png"/>
      <include name="**/*.gif"/>
      <include name="**/*.bmp"/>
      <include name="**/*.jpeg"/>
    </fileset>
    </copy>

    <javac destdir="${temp}" debug="true" fork="true" nowarn="true">

      <src path="${gensrc}" />
      <src path="${permsrc}" />      
      <src path="${main}" />

      <classpath>

        <pathelement path="${temp}" />

        <fileset dir="${lib}">

          <include name="**/*.jar" />

        </fileset>

      </classpath>

    </javac>   
  </target>
  
   <target name="rundebug" depends="compile">
	  
	  <java fork="true" failonerror="true" maxmemory="128m"
		
		classname="ingenias.jade.Main">
		  <jvmarg line="-Xdebug -Xrunjdwp:transport=dt_socket,address=60005,server=y,suspend=n"/>
		  <classpath>
			  
			  <pathelement path="${temp}" />        

			  <fileset dir="${lib}">
				  
				  <include name="**/*.jar" />
				  
			  </fileset>
			  
		  </classpath>
		  
	  </java>
	  
  </target>
  
  <target name="emptyTarget"/>
   
  <target name="alljunit" depends="@@@repeat id="testingnode"@@@junit@@@v@@@testingconfig@@@/v@@@,@@@/repeat@@@emptyTarget"/>
 
   <target name="test" depends="compile">
        <mkdir dir="${test.results.dir}"/>
        <junit showoutput="true"
           fork="true"
           failureproperty="tests.failed"
           errorproperty="tests.failed">
            <batchtest todir="${test.results.dir}">
                <fileset dir="${gensrc}">
                    <include name="ingenias/testing/*.java"/>
                    <exclude name="ingenias/testing/*Launcher.java"/>
                </fileset>
            </batchtest>
            <classpath>

                <pathelement path="${temp}" />
                <fileset dir="${lib}">
                    <include name="**/*.jar" />
                </fileset>

            </classpath>
            <formatter usefile="false" type="brief"/>
            <formatter type="xml"/>
        </junit>
    </target>
    <!--  Targets to run simulations defined in the system -->
   @@@repeat id="simulationnode"@@@

   @@@repeat id="deploynode"@@@
   
    <target name="simulate@@@v@@@simulationconfig@@@/v@@@" depends="compile">
    <java fork="true" failonerror="true" maxmemory="@@@v@@@memory@@@/v@@@"
    classname="org.junit.runner.JUnitCore">
    <arg line="ingenias.simulation.@@@v@@@simulationconfig@@@/v@@@"/>    
      <classpath>

		<pathelement path="${temp}" />        
        <fileset dir="${lib}">
          <include name="**/*.jar" />
        </fileset>

      </classpath>

    </java>
  </target>

   

  	  @@@/repeat@@@

  @@@/repeat@@@
  
    <!--  Targets to run tests defined in the system -->
  @@@repeat id="testingnode"@@@

   @@@repeat id="deploynode"@@@
   
    <target name="junit@@@v@@@testingconfig@@@/v@@@" depends="compile">
    <java fork="true" failonerror="true" maxmemory="@@@v@@@memory@@@/v@@@"
    classname="org.junit.runner.JUnitCore">
    <arg line="ingenias.testing.@@@v@@@testingconfig@@@/v@@@Launcher"/>    
      <classpath>

		<pathelement path="${temp}" />        
        <fileset dir="${lib}">
          <include name="**/*.jar" />
        </fileset>

      </classpath>

    </java>
  </target>

   

  	  @@@/repeat@@@

  @@@/repeat@@@
  
  @@@repeat id="deploynode"@@@
  <!--   Runs a MAS created with the jade module and contained in the node @@@v@@@node@@@/v@@@ -->

<target name="run@@@v@@@node@@@/v@@@ProdStandAlone" depends="compile">
    <java fork="true" failonerror="true" maxmemory="@@@v@@@memory@@@/v@@@"
    classname="ingenias.jade.Main@@@v@@@node@@@/v@@@ProdStandAlone">
    <arg line="@@@v@@@port@@@/v@@@"/>
    
      <classpath>

		<pathelement path="${temp}" />        
        <fileset dir="${lib}">

          <include name="**/*.jar" />

        </fileset>

      </classpath>

    </java>
  </target>

  <target name="run@@@v@@@node@@@/v@@@" depends="compile">
    <java fork="true" failonerror="true" maxmemory="@@@v@@@memory@@@/v@@@"
    classname="ingenias.jade.Main@@@v@@@node@@@/v@@@">
    <arg line="@@@v@@@port@@@/v@@@"/>
    
      <classpath>

		<pathelement path="${temp}" />        
        <fileset dir="${lib}">

          <include name="**/*.jar" />

        </fileset>

      </classpath>

    </java>
  </target>
  
   <target name="runjade@@@v@@@node@@@/v@@@">
    <java fork="true" failonerror="true" maxmemory="128m"
    classname="jade.Boot">
	<arg line="-gui -port @@@v@@@port@@@/v@@@ -mtp 'jade.mtp.http.MessageTransportProtocol(http://127.0.0.1:@@@v@@@fedport@@@/v@@@/acc)' -file-dir jade/"/>
      <classpath>
        <pathelement path="${temp}" />
	    
        <fileset dir="${lib}">

          <include name="**/*.jar" />

        </fileset>

      </classpath>

    </java>
  </target>
  
   <target name="runfederatedjade@@@v@@@node@@@/v@@@">
    <java fork="true" failonerror="true" maxmemory="128m"
    classname="jade.Boot">
    <arg line="-gui -port @@@v@@@port@@@/v@@@ -mtp 'jade.mtp.http.MessageTransportProtocol(http://127.0.0.1:@@@v@@@fedport@@@/v@@@/acc)' -file-dir jade/ subDF:jade.domain.df federator:jade.misc.DFFederatorAgent(resources/DFFederatorAgent.properties)"/>	
      <classpath>
        <pathelement path="${temp}" />
	    
        <fileset dir="${lib}">

          <include name="**/*.jar" />

        </fileset>

      </classpath>

    </java>
  </target>
  
  <target name="debug@@@v@@@node@@@/v@@@" depends="compile">
	  
	  <java fork="true" failonerror="true" maxmemory="256m"
		classname="ingenias.jade.Main@@@v@@@node@@@/v@@@">
		  <jvmarg line="-Xdebug -Xrunjdwp:transport=dt_socket,address=60005,server=y,suspend=n"/>
		 <arg line="@@@v@@@port@@@/v@@@"/>

		  <classpath>
			  
			  <pathelement path="${temp}" />        
			  
			  <fileset dir="${lib}">
				  
				  <include name="**/*.jar" />
				  
			  </fileset>
			  
		  </classpath>
		  
	  </java>
	  
  </target>
  @@@/repeat@@@
  </project>
 @@@/text@@@
 @@@/saveto@@@
@@@/program@@@
